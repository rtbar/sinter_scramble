(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))l(e);new MutationObserver(e=>{for(const c of e)if(c.type==="childList")for(const a of c.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&l(a)}).observe(document,{childList:!0,subtree:!0});function o(e){const c={};return e.integrity&&(c.integrity=e.integrity),e.referrerPolicy&&(c.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?c.credentials="include":e.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function l(e){if(e.ep)return;e.ep=!0;const c=o(e);fetch(e.href,c)}})();const O=""+new URL("photo_1-VKNFUsTZ.jpg",import.meta.url).href,w=""+new URL("photo_2-B7Tn505n.jpg",import.meta.url).href,$=""+new URL("photo_3-K2pGZrIL.jpg",import.meta.url).href,E=""+new URL("photo_final-Bu6DBl97.jpg",import.meta.url).href,d=3,I=Object.assign({"./assets/photo_1.jpg":O,"./assets/photo_2.jpg":w,"./assets/photo_3.jpg":$,"./assets/photo_final.jpg":E});let u=Object.keys(I).filter(t=>t.match(/photo_\d+\.jpg$/)).sort((t,n)=>{var e,c;const o=parseInt(((e=t.match(/photo_(\d+)\.jpg$/))==null?void 0:e[1])||0),l=parseInt(((c=n.match(/photo_(\d+)\.jpg$/))==null?void 0:c[1])||0);return o-l}).map(t=>I[t]);if(u.length===0){const t=Object.assign({});Object.keys(t).length>0?u=Object.values(t):u=["https://picsum.photos/450/450"]}let i=parseInt(localStorage.getItem("sinter_scramble_level")||"0");(i>=u.length||i<0)&&(i=0);const r=document.getElementById("board"),g=document.getElementById("congrats-modal"),L=document.getElementById("modal-title"),x=document.getElementById("modal-message"),M=document.getElementById("close-modal-btn"),p=document.getElementById("continue-btn"),b=document.getElementById("controls-container"),f=document.getElementById("level-indicator");let h=[],s=null,y=0,v=0;function C(){f.textContent=`Container ${i+1}/${u.length}`,r.innerHTML="",r.classList.remove("solved"),g.classList.add("hidden"),b.classList.add("hidden"),h=[];const t=u[i];for(let l=0;l<d*d;l++){const e=document.createElement("div");e.classList.add("drop-zone"),e.dataset.index=l,e.addEventListener("dragover",z),e.addEventListener("drop",k),r.appendChild(e)}for(let l=0;l<d*d;l++){const e=document.createElement("div");e.classList.add("tile"),e.draggable=!0,e.id=`tile-${l}`,e.dataset.correctIndex=l;const c=Math.floor(l/d),a=l%d;e.style.backgroundImage=`url(${t})`,e.style.backgroundPosition=`${a*50}% ${c*50}%`,e.addEventListener("dragstart",B),e.addEventListener("dragend",D),e.addEventListener("touchstart",A,{passive:!1}),e.addEventListener("touchmove",N,{passive:!1}),e.addEventListener("touchend",P),e.addEventListener("touchcancel",R),h.push(e)}const n=localStorage.getItem(`sinter_scramble_state_level_${i}`),o=document.querySelectorAll(".drop-zone");if(n)try{JSON.parse(n).forEach((e,c)=>{if(e!==null){const a=h.find(j=>parseInt(j.dataset.correctIndex)===e);a&&o[c].appendChild(a)}}),T()}catch(l){console.error("Failed to load saved state",l),[...h].sort(()=>Math.random()-.5).forEach((c,a)=>{o[a].appendChild(c)}),_()}else[...h].sort(()=>Math.random()-.5).forEach((e,c)=>{o[c].appendChild(e)}),_()}let m=null;function B(t){m=this,this.classList.add("dragging"),t.dataTransfer.effectAllowed="move"}function D(t){this.classList.remove("dragging"),m=null}function z(t){t.preventDefault(),t.dataTransfer.dropEffect="move"}function k(t){t.preventDefault();const n=t.target.closest(".drop-zone");n&&m&&S(m,n)}function _(){const t=document.querySelectorAll(".drop-zone"),n=[];t.forEach(o=>{const l=o.querySelector(".tile");l?n.push(parseInt(l.dataset.correctIndex)):n.push(null)}),localStorage.setItem(`sinter_scramble_state_level_${i}`,JSON.stringify(n))}function S(t,n){if(!t||!n)return;const o=n.querySelector(".tile"),l=t.parentNode;o&&l&&l.appendChild(o),n.appendChild(t),_(),T()}function A(t){if(t.touches.length!==1)return;s=t.currentTarget,s.classList.add("dragging");const n=t.touches[0],o=s.getBoundingClientRect();y=n.clientX-o.left,v=n.clientY-o.top,s.style.position="fixed",s.style.left=n.clientX-y+"px",s.style.top=n.clientY-v+"px",s.style.zIndex="1000",s.style.width=o.width+"px",s.style.height=o.height+"px",t.preventDefault()}function N(t){if(!s)return;t.preventDefault();const n=t.touches[0];s.style.left=n.clientX-y+"px",s.style.top=n.clientY-v+"px"}function P(t){var e;if(!s)return;t.preventDefault(),s.style.display="none";const n=t.changedTouches[0],o=document.elementFromPoint(n.clientX,n.clientY);s.style.display="";const l=(e=o==null?void 0:o.closest)==null?void 0:e.call(o,".drop-zone");s.classList.remove("dragging"),s.style.position="",s.style.left="",s.style.top="",s.style.zIndex="",s.style.width="",s.style.height="",l&&S(s,l),s=null}function R(){s&&(s.classList.remove("dragging"),s.style.position="",s.style.left="",s.style.top="",s.style.zIndex="",s.style.width="",s.style.height="",s=null)}function T(){const t=document.querySelectorAll(".drop-zone");let n=0;console.group("Check Win Status"),t.forEach(o=>{const l=o.querySelector(".tile");if(l){const e=parseInt(o.dataset.index),c=parseInt(l.dataset.correctIndex);e===c?n++:console.log(`Mismatch: Zone ${e} has Tile ${c}`)}else console.log(`Empty Zone: ${o.dataset.index}`)}),console.groupEnd(),console.log(`Correct tiles: ${n}/${d*d}`),n===d*d&&(console.log("Puzzle Solved! Triggering modal..."),setTimeout(()=>{q()},200))}document.addEventListener("keydown",t=>{t.altKey&&t.key==="d"&&(document.body.classList.toggle("debug-mode"),console.log("Debug mode toggled"))});function q(){if(console.log("showWinModal executing..."),!g){console.error("Modal element missing!");return}g.classList.remove("hidden"),r.classList.add("solved"),M.onclick=()=>{g.classList.add("hidden")},b.classList.remove("hidden"),i<u.length-1?(L.textContent="Access Granted",x.textContent=`Correct key hash entered. Container ${i+1}/${u.length} has been unlocked.`,p.textContent="Proceed to Next Container",p.onclick=()=>{i++,localStorage.setItem("sinter_scramble_level",i),localStorage.removeItem(`sinter_scramble_state_level_${i}`),C()}):(L.textContent="Decryption Successful",x.textContent="All containers unlocked. Data retrieved.",p.textContent="Open Decrypted Container",p.onclick=()=>{F()})}function F(){g.classList.add("hidden"),b.classList.add("hidden"),r.innerHTML="",r.style.display="flex",r.style.justifyContent="center",r.style.alignItems="center",r.style.background="none",r.style.border="none",r.style.boxShadow="none";const t=Object.assign({"./assets/photo_final.jpg":E});let n="https://picsum.photos/450/450";Object.keys(t).length>0&&(n=Object.values(t)[0]);const o=document.createElement("img");o.src=n,o.style.maxWidth="100%",o.style.maxHeight="100%",o.style.borderRadius="8px",o.style.boxShadow="0 0 20px rgba(255, 215, 0, 0.5)",r.appendChild(o),f.textContent="Go get me, Maarten!",f.style.color="#FFD700",f.style.textShadow="0 0 10px rgba(255, 215, 0, 0.5)"}C();
